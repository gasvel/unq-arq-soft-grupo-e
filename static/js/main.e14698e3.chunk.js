(this.webpackJsonpmercado_trucho=this.webpackJsonpmercado_trucho||[]).push([[0],{39:function(e,t,a){},41:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),s=a(30),c=a.n(s),i=(a(39),a(5)),o=a(6),l=a(7),d=a(8),u=a(3),h=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={error:null,isLoaded:!1,products:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("https://arq1-meli-grupo-e.herokuapp.com/products").then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoaded:!0,items:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,n=e.items;return t?Object(u.jsxs)("div",{children:["Error: ",t.message]}):a?Object(u.jsx)("div",{children:n.map((function(e){return Object(u.jsxs)("div",{className:"product-card",children:[Object(u.jsx)("div",{className:"product-image",children:Object(u.jsx)("img",{src:e.photo,height:"100px"})}),Object(u.jsxs)("div",{className:"product-content",children:[Object(u.jsx)("h2",{children:e.nombre}),Object(u.jsx)("p",{children:e.descripcion}),"$ ",e.valor]})]},e._id)}))}):Object(u.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component),j=a(2),b=a(10),m=a(11),p=(a(41),a(24)),O=(a(43),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={previewImg:null},n.props.preview&&(n.state={previewImg:n.props.preview}),n.handleSubmit=n.handleSubmit.bind(Object(m.a)(n)),n.fileInput=r.a.createRef(),n.handleFileSelection=n.handleFileSelection.bind(Object(m.a)(n)),n}return Object(o.a)(a,[{key:"handleFileSelection",value:function(e){var t=URL.createObjectURL(e.target.files[0]);this.setState({previewImg:t})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=Object(p.b)(),n=localStorage.getItem("user"),r=Object(p.c)(a,n+Date.now().toString()+".jpg");Object(p.d)(r,this.fileInput.current.files[0]).then((function(e){Object(p.a)(e.ref).then((function(e){t.props.onImageUploaded(e),alert("Foto cargada con \xe9xito")}))}))}},{key:"render",value:function(){var e=null!=this.state.previewImg?Object(u.jsx)("img",{src:this.state.previewImg,className:"imgPreview",alt:"ProductImg"}):Object(u.jsx)("span",{});return Object(u.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(u.jsx)("div",{className:"imgSection",children:e}),Object(u.jsxs)("label",{children:["Selecciona una foto del producto:",Object(u.jsx)("input",{type:"file",accept:"image/jpeg",ref:this.fileInput,onChange:this.handleFileSelection})]}),Object(u.jsx)("br",{}),Object(u.jsx)("button",{type:"submit",children:"Subir"})]})}}]),a}(r.a.Component)),g=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={error:null,isLoaded:!0,product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"}},console.log(n.props.product),n.props.product&&(n.state=Object(b.a)(Object(b.a)({},n.state),{},{product:n.props.product})),n.handleFieldChange=n.handleFieldChange.bind(Object(m.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(m.a)(n)),n.handleImgUploaded=n.handleImgUploaded.bind(Object(m.a)(n)),n}return Object(o.a)(a,[{key:"handleFieldChange",value:function(e){var t=e.target,a=t.name,n="valor"===a||"stock"===a?parseInt(t.value):t.value;this.setState(Object(b.a)(Object(b.a)({},this.state),{},{product:Object(b.a)(Object(b.a)({},this.state.product),{},Object(j.a)({},a,n))}))}},{key:"handleImgUploaded",value:function(e){this.setState(Object(b.a)(Object(b.a)({},this.state),{},{product:Object(b.a)(Object(b.a)({},this.state.product),{},{photo:e})}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=localStorage.getItem("user");if(this.state.product.photo){var n=Object(b.a)(Object(b.a)({},this.state.product),{},{owner:a});this.setState(Object(b.a)(Object(b.a)({},this.state),{},{isLoaded:!1}));var r=this.state.product._id?{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},s="https://arq1-meli-grupo-e.herokuapp.com/products";this.state.product._id&&(s=s+"/"+this.state.product._id),fetch(s,r).then((function(e){console.log(e),t.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:null,isLoaded:!0}),t.props.onProductCreated()})).catch((function(e){t.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:e,isLoaded:!0})}))}else alert("Debe cargar una imagen del producto para poder publicarlo.")}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,n=this.state.product._id?"Actualizar":"Crear producto";return t?Object(u.jsxs)("div",{children:["Error: ",t.message]}):a?Object(u.jsxs)("div",{className:"product-form",children:[Object(u.jsx)(O,{onImageUploaded:this.handleImgUploaded,preview:this.state.product.photo}),Object(u.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Nombre:",Object(u.jsx)("input",{type:"text",name:"nombre",required:"true",value:this.state.product.nombre,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Descripci\xf3n:",Object(u.jsx)("textarea",{name:"descripcion",value:this.state.product.descripcion,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Valor: $",Object(u.jsx)("input",{name:"valor",type:"number",required:"true",value:this.state.product.valor,min:"1",onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Stock:",Object(u.jsx)("input",{name:"stock",type:"number",required:"true",value:this.state.product.stock,min:"1",onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Categoria:",Object(u.jsxs)("select",{name:"categoria",value:this.state.product.categoria,onChange:this.handleFieldChange,children:[Object(u.jsx)("option",{value:"Agro",children:"Agro"}),Object(u.jsx)("option",{value:"Alimentos",children:"Alimentos"}),Object(u.jsx)("option",{value:"Arte",children:"Arte"}),Object(u.jsx)("option",{value:"Colleciones",children:"Coleciones"}),Object(u.jsx)("option",{value:"Deportes",children:"Deportes"}),Object(u.jsx)("option",{value:"Inmuebles",children:"Inmuebles"}),Object(u.jsx)("option",{value:"Mascotas",children:"Mascotas"}),Object(u.jsx)("option",{value:"Tecnologia",children:"T\xe9cnologia"}),Object(u.jsx)("option",{value:"Vehiculos",children:"Veh\xedculos"}),Object(u.jsx)("option",{value:"Vestimenta",children:"Vestimenta"})]})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsx)("button",{type:"submit",title:n,children:n})})]})]}):Object(u.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component),v=(a(44),a.p+"static/media/ml.270e3502.png"),f=a.p+"static/media/lupa.81ec5dc4.png",x=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).goToCreation=function(){e.props.onProductCreationEvent()},e.goHome=function(){e.props.onHome()},e.goToRegister=function(){e.props.onRegister()},e.goToUserProducts=function(){e.props.onUserProducts()},e.signOut=function(){localStorage.removeItem("user"),e.goHome()},e}return Object(o.a)(a,[{key:"render",value:function(){var e,t,a=localStorage.getItem("user"),n=localStorage.getItem("username"),r=Object(u.jsx)("div",{className:"nav-option",onClick:this.goToRegister,children:"Registrarme"});return null!==a&&(r=Object(u.jsxs)("div",{className:"nav-option",onClick:this.signOut,children:[n," ,Salir"]}),e=Object(u.jsx)("li",{children:Object(u.jsx)("div",{class:"nav-option",onClick:this.goToCreation,children:"Publicar"})}),t=Object(u.jsx)("li",{children:Object(u.jsx)("div",{class:"nav-option",onClick:this.goToUserProducts,children:"Mis productos"})})),Object(u.jsxs)("header",{className:"site-header",children:[Object(u.jsx)("div",{className:"logo",children:Object(u.jsxs)("a",{href:"/",children:[Object(u.jsx)("img",{className:"logoImg",src:v,alt:"MercadoTrucho"}),Object(u.jsx)("b",{children:"MercadoTrucho"})]})}),Object(u.jsx)("div",{className:"header-middle-area",children:Object(u.jsx)("nav",{className:"main-nav",id:"main-nav",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:Object(u.jsx)("div",{className:"nav-option",onClick:this.goHome,children:"Home"})}),Object(u.jsx)("li",{children:Object(u.jsx)("div",{className:"nav-option",children:"Categorias"})}),Object(u.jsx)("li",{children:Object(u.jsx)("div",{className:"nav-option",children:"M\xe1s vendidos"})}),e,t]})})}),Object(u.jsx)("nav",{className:"search-and-account",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:Object(u.jsx)("img",{src:f,className:"search-img",alt:"Buscar"})}),Object(u.jsx)("li",{children:r})]})})]})}}]),a}(r.a.Component),S=x,C=(a(45),a(46),a(27)),k=a.n(C),y=a(20),N=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={error:null,isLoaded:!0,user:{nombre:"",apellido:"",username:"",password:"",seller:!1,email:"",razonSocial:"",emailCorporativo:""}},n.handleFieldChange=n.handleFieldChange.bind(Object(m.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(m.a)(n)),n.handleGoogleSignIn=n.handleGoogleSignIn.bind(Object(m.a)(n)),n}return Object(o.a)(a,[{key:"handleGoogleSignIn",value:function(e){var t=new y.a,a=Object(y.b)();Object(y.c)(a,t).then((function(e){var t=y.a.credentialFromResult(e).accessToken,a=e.user;console.log(JSON.stringify(a)),console.log(t)})).catch((function(e){e.code,e.message,e.email,y.a.credentialFromError(e)}))}},{key:"handleFieldChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(b.a)(Object(b.a)({},this.state),{},{user:Object(b.a)(Object(b.a)({},this.state.user),{},Object(j.a)({},n,a))}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState(Object(b.a)(Object(b.a)({},this.state),{},{isLoaded:!1}));var a={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"http://localhost:3000"},body:JSON.stringify(this.state.user.map((function(e,t){return"password"===e?k.a.encrypt(t,"es un secreto").toString():t})))};fetch("https://arq1-meli-grupo-e.herokuapp.com/users",a).then((function(e){console.log(e),t.setState({user:{nombre:"",apellido:"",username:"",password:"",seller:!1,email:"",razonSocial:"",emailCorporativo:""},error:null,isLoaded:!0}),200===e.status?t.props.onUserCreated():alert("Ocurri\xf3 un error en el registro. Por favor intente nuevamente: "+e.statusText)})).catch((function(e){t.setState({user:{nombre:"",apellido:"",username:"",password:"",seller:!1,email:"",razonSocial:"",emailCorporativo:""},error:e,isLoaded:!0}),alert("Ocurri\xf3 un error en el registro. Por favor intente nuevamente ")}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,n=e.user,r=Object(y.b)().currentUser;console.log(r);var s=Object(u.jsx)("br",{});return r&&r.displayName,n.esVendedor&&(s=Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Raz\xf3n Social:",Object(u.jsx)("input",{type:"text",name:"razonSocial",value:n.razonSocial,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Mail Corporativo:",Object(u.jsx)("input",{name:"emailCorporativo",type:"email",value:n.emailCorporativo,onChange:this.handleFieldChange})]})})]})),t?Object(u.jsxs)("div",{children:["Error: ",t.message]}):a?Object(u.jsxs)("div",{className:"product-form",children:[Object(u.jsx)("button",{className:"google-sign-in-btn",onClick:this.handleGoogleSignIn,children:"Registrarme con mi cuenta de Google"}),Object(u.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Nombre:",Object(u.jsx)("input",{type:"text",name:"nombre",value:n.nombre,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Apellido:",Object(u.jsx)("input",{type:"text",name:"apellido",value:n.apellido,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Nombre de usuario:",Object(u.jsx)("input",{type:"text",name:"username",value:n.username,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Mail:",Object(u.jsx)("input",{name:"email",type:"email",value:n.email,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Contrase\xf1a:",Object(u.jsx)("input",{name:"password",type:"password",value:n.password,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Es vendedor?:",Object(u.jsx)("input",{type:"checkbox",name:"seller",checked:n.seller,onChange:this.handleFieldChange})]})}),s,Object(u.jsx)("div",{className:"form-field",children:Object(u.jsx)("button",{type:"submit",children:"Terminar registro"})})]})]}):Object(u.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component),I=(a(53),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={error:null,isLoaded:!0,user:{username:"",password:""}},n.handleFieldChange=n.handleFieldChange.bind(Object(m.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(m.a)(n)),n}return Object(o.a)(a,[{key:"handleFieldChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(b.a)(Object(b.a)({},this.state),{},{user:Object(b.a)(Object(b.a)({},this.state.user),{},Object(j.a)({},n,a))}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState(Object(b.a)(Object(b.a)({},this.state),{},{isLoaded:!1})),fetch("https://arq1-meli-grupo-e.herokuapp.com/users/"+this.state.user.username+"&"+this.state.user.password).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({user:{username:"",password:""},error:null,isLoaded:!0}),e?(localStorage.setItem("user",e._id),localStorage.setItem("username",e.username),t.props.onUserLogin()):alert("Ocurri\xf3 un error en el ingreso. Por favor intente nuevamente: "+e.statusText)})).catch((function(e){t.setState({user:{username:"",password:""},error:e,isLoaded:!0}),alert("Ocurri\xf3 un error en el ingreso Por favor intente nuevamente ")}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,n=e.user;return t?Object(u.jsxs)("div",{children:["Error: ",t.message]}):a?Object(u.jsx)("div",{className:"product-form",children:Object(u.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Nombre de usuario:",Object(u.jsx)("input",{type:"text",name:"username",value:n.username,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsxs)("label",{children:["Contrase\xf1a:",Object(u.jsx)("input",{name:"password",type:"password",value:n.password,onChange:this.handleFieldChange})]})}),Object(u.jsx)("div",{className:"form-field",children:Object(u.jsx)("button",{type:"submit",children:"Ingresar"})})]})}):Object(u.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component)),F=a(31),P=a(33),L=(a(54),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleDelete=function(e){n.setState(Object(b.a)(Object(b.a)({},n.state),{},{isLoaded:!1}));fetch("https://arq1-meli-grupo-e.herokuapp.com/products/"+e,{method:"DELETE"}).then((function(e){console.log(e),n.setState(Object(b.a)(Object(b.a)({},n.state),{},{error:null,isLoaded:!0})),n.componentDidMount()})).catch((function(e){n.setState(Object(b.a)(Object(b.a)({},n.state),{},{error:e,isLoaded:!0}))}))},n.handleEdit=function(e){n.props.onProductEdit(e)},n.state={error:null,isLoaded:!1,items:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("https://arq1-meli-grupo-e.herokuapp.com/products/"+localStorage.getItem("user")).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoaded:!0,items:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,n=t.isLoaded;t.items;return a?Object(u.jsxs)("div",{children:["Error: ",a.message]}):n?Object(u.jsx)("div",{children:this.state.items.map((function(t){return Object(u.jsxs)("div",{className:"product-card",children:[Object(u.jsx)("div",{className:"product-image",children:Object(u.jsx)("img",{src:t.photo,height:"100px"})}),Object(u.jsxs)("div",{className:"product-content",children:[Object(u.jsx)("h2",{children:t.nombre}),Object(u.jsx)("p",{children:t.descripcion}),"$ ",t.valor]}),Object(u.jsxs)("div",{className:"footer",children:[Object(u.jsx)("button",{title:"Borrar",onClick:function(){e.handleDelete(t._id)},children:"Eliminar"}),Object(u.jsx)("br",{}),Object(u.jsx)("button",{title:"Editar",onClick:function(){e.handleEdit(t)},children:"Editar"})]})]},t._id)}))}):Object(u.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component)),w=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){!function(){var e=Object(F.a)({apiKey:"AIzaSyBVwJk4DI_k64X4sTyoFcG6uxvI_qnJk-Q",authDomain:"unq-arq-soft-1-grupo-e.firebaseapp.com",projectId:"unq-arq-soft-1-grupo-e",storageBucket:"unq-arq-soft-1-grupo-e.appspot.com",messagingSenderId:"1064909149315",appId:"1:1064909149315:web:42677b0348548404f2f7b6",measurementId:"G-MLY1S1NYFG"});Object(P.a)(e)}()},n.handleProductCreation=function(){alert("Producto Creado")},n.handleLogin=function(){n.setState({screen:"list"})},n.handleCreationScreen=function(){n.setState({screen:"createProduct"})},n.handleProductEdit=function(e){n.setState({screen:"editProduct",product:e})},n.handleHomeScreen=function(){n.setState({screen:"login"})},n.handleRegisterScreen=function(){n.setState({screen:"createUser"})},n.handleUserProductsScreen=function(){n.setState({screen:"userProducts"})},n.state={screen:"login"},n}return Object(o.a)(a,[{key:"render",value:function(){var e;switch("login"===this.state.screen&&null!==localStorage.getItem("user")&&this.setState({screen:"list"}),this.state.screen){case"createProduct":e=Object(u.jsx)(g,{onProductCreated:this.handleProductCreation});break;case"createUser":e=Object(u.jsx)(N,{onUserCreated:this.handleHomeScreen});break;case"list":e=Object(u.jsx)(h,{});break;case"userProducts":e=Object(u.jsx)(L,{onProductEdit:this.handleProductEdit});break;case"editProduct":e=Object(u.jsx)(g,{onProductCreated:this.handleProductCreation,product:this.state.product});break;default:e=Object(u.jsx)(I,{onUserLogin:this.handleLogin})}return Object(u.jsxs)("div",{className:"App","data-testid":"App",children:[Object(u.jsx)(S,{onProductCreationEvent:this.handleCreationScreen,onHome:this.handleHomeScreen,onRegister:this.handleRegisterScreen,onUserProducts:this.handleUserProductsScreen}),e]})}}]),a}(r.a.Component),T=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,56)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))};c.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(w,{})}),document.getElementById("root")),T()}},[[55,1,2]]]);
//# sourceMappingURL=main.e14698e3.chunk.js.map