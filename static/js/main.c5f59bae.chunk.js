(this.webpackJsonpmercado_trucho=this.webpackJsonpmercado_trucho||[]).push([[0],{100:function(e,t,a){},104:function(e,t,a){},106:function(e,t,a){},109:function(e,t,a){},110:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},113:function(e,t,a){},115:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),s=a(32),c=a.n(s),o=(a(100),a(7)),i=a(9),l=a(13),d=a(14),h=a(3),u=a(16),j=a(133),b=a(121),p=a(122),g=a(131),O=a(123),m=a(88),x=a(54),v=a(124),f=a(89),C=a(132),S=a(0),y=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).changePage=function(e){var t=e.target.textContent,a=r.state.limit*(t-1),n=a+r.state.limit>r.state.items.length-1?r.state.items.length-1:a+r.state.limit;console.log(a),console.log(n),r.setState(Object(h.a)(Object(h.a)({},r.state),{},{page:t,pageItems:r.state.items.slice(a,n)}))},r.handleBuy=function(e){r.props.onProductBuy(e)},r.state={error:null,isLoaded:!1,items:[],pageItems:[],gte:0,lte:0,limit:10,page:1,category:""===e.category?null:e.category,searchText:""===e.search?null:e.serach},r.filterProducts=r.filterProducts.bind(Object(u.a)(r)),r.handleChangeGte=r.handleChangeGte.bind(Object(u.a)(r)),r.handleChangeLte=r.handleChangeLte.bind(Object(u.a)(r)),r}return Object(i.a)(a,[{key:"handleChangeGte",value:function(e){var t=e.target,a=parseInt(t.value);this.setState(Object(h.a)(Object(h.a)({},this.state),{},{gte:a}))}},{key:"handleChangeLte",value:function(e){var t=e.target,a=parseInt(t.value);this.setState(Object(h.a)(Object(h.a)({},this.state),{},{lte:a}))}},{key:"getSnapshotBeforeUpdate",value:function(e){return{notifyRequired:e.search!==this.props.search||e.category!==this.props.category}}},{key:"componentDidUpdate",value:function(e,t,a){if(a.notifyRequired){var r=[];null!=this.props.category&&r.push("categoria="+this.props.category),null!=this.props.search&&r.push("nombre="+this.props.search),null!=this.state.lte&&0!=this.state.lte&&r.push("lte="+this.state.lte),null!=this.state.gte&&0!=this.state.gte&&r.push("gte="+this.state.gte),r.length>0&&(r=r.join("&"),this.getProducts(r))}}},{key:"componentDidMount",value:function(){var e=[];null!=this.state.category&&e.push("categoria="+this.state.category),null!=this.state.lte&&0!=this.state.lte&&e.push("lte="+this.state.lte),null!=this.state.gte&&0!=this.state.gte&&e.push("gte="+this.state.gte),null!=this.state.search&&e.push("nombre="+this.state.searchText),e.length>0&&(e=e.join("&"),this.getProducts(e)),this.getProducts()}},{key:"filterProducts",value:function(){var e=[];null!=this.state.lte&&0!=this.state.lte&&e.push("lte="+this.state.lte),null!=this.state.gte&&0!=this.state.gte&&e.push("gte="+this.state.gte),e.length>0&&(this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1})),e=e.join("&"),this.getProducts(e))}},{key:"getProducts",value:function(e){var t=this,a="";e&&(a="?"+e),console.log(a),fetch("https://arq1-meli-grupo-e.herokuapp.com/products"+a).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({isLoaded:!0,items:e,pageItems:e.slice(0,t.state.limit)})}),(function(e){t.setState({isLoaded:!0,error:e})}))}},{key:"render",value:function(){for(var e=this,t=this.state,a=t.error,r=t.isLoaded,n=(t.items,t.pageItems),s=localStorage.getItem("user"),c=[],o=1;o<=Math.ceil(this.state.items.length/this.state.limit);o++)c.push(Object(S.jsx)(j.a.Item,{active:o===this.state.page,onClick:this.changePage,children:o},o));return a?Object(S.jsxs)("div",{"data-testid":"Listado",children:["Error: ",a.message]}):r?n.length>0?Object(S.jsxs)(p.a,{fluid:"lg",style:{padding:"1%"},"data-testid":"Listado",children:[Object(S.jsx)(g.a,{defaultActiveKey:"",children:Object(S.jsxs)(g.a.Item,{eventKey:"0",children:[Object(S.jsx)(g.a.Header,{children:"Filtrar resultado"}),Object(S.jsxs)(g.a.Body,{children:[Object(S.jsxs)(O.a,{className:"mb-3",children:[Object(S.jsx)(O.a.Text,{id:"basic-addon1",children:"Valor mayor a: "}),Object(S.jsx)(m.a,{placeholder:"0","aria-label":"0","aria-describedby":"basic-addon1",type:"number",value:this.state.gte,onChange:this.handleChangeGte})]}),Object(S.jsxs)(O.a,{className:"mb-3",children:[Object(S.jsx)(O.a.Text,{id:"basic-addon2",children:"Valor menor a: "}),Object(S.jsx)(m.a,{placeholder:"0","aria-label":"0","aria-describedby":"basic-addon2",type:"number",value:this.state.lte,onChange:this.handleChangeLte})]}),Object(S.jsx)(x.a,{variant:"success",onClick:this.filterProducts,children:"Filtrar"})]})]})}),Object(S.jsx)(v.a,{children:n.map((function(t){return Object(S.jsx)(f.a,{children:Object(S.jsxs)(C.a,{style:{width:"18rem",height:"500px"},children:[Object(S.jsx)(C.a.Img,{variant:"top",src:t.photo}),Object(S.jsx)(C.a.Body,{children:Object(S.jsx)(C.a.Title,{children:t.nombre})}),Object(S.jsxs)(C.a.Text,{children:["Cantidad disponible: ",t.stock]}),Object(S.jsxs)(C.a.Text,{children:["$ ",t.valor]}),Object(S.jsx)(x.a,{variant:"primary",onClick:function(){e.handleBuy(t._id)},disabled:null==s,children:"Comprar"})]})},t._id)}))}),Object(S.jsx)("div",{style:{textAlign:"center"},children:Object(S.jsx)(j.a,{style:{paddingLeft:"50%"},children:c})})]}):void p.a:Object(S.jsx)(b.a,{animation:"border",role:"status",children:Object(S.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}}]),a}(n.a.Component),k=a(4),P=(a(104),a(17)),I=a(60),L=a(90),T=a(94),N=Object(L.a)({apiKey:"AIzaSyBVwJk4DI_k64X4sTyoFcG6uxvI_qnJk-Q",authDomain:"unq-arq-soft-1-grupo-e.firebaseapp.com",projectId:"unq-arq-soft-1-grupo-e",storageBucket:"unq-arq-soft-1-grupo-e.appspot.com",messagingSenderId:"1064909149315",appId:"1:1064909149315:web:42677b0348548404f2f7b6",measurementId:"G-MLY1S1NYFG"}),A=(Object(T.a)(N),Object(I.b)(N)),U=a(130),F=a(125),B=a(126),E=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).submitCsv=function(){r.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:null,isLoaded:!1}),console.log(r.state.csv),r.state.csv&&Object(P.b)().currentUser.getIdToken(!0).then((function(e){var t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({csv:r.state.csv})};fetch("https://arq1-meli-grupo-e.herokuapp.com/products/csv",t).then((function(e){console.log(e),r.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:null,isLoaded:!0}),r.props.onProductCreated()})).catch((function(e){console.log(e),r.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:e,isLoaded:!0})}))}))},r.state={previewImg:null,csv:null,error:null,isLoaded:!0,product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"}},r.fileInput=n.a.createRef(),r.csvInput=n.a.createRef(),r.handleFileCsv=r.handleFileCsv.bind(Object(u.a)(r)),r.handleFileSelection=r.handleFileSelection.bind(Object(u.a)(r)),r.props.product&&(r.state=Object(h.a)(Object(h.a)({},r.state),{},{product:r.props.product})),r.handleFieldChange=r.handleFieldChange.bind(Object(u.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(u.a)(r)),r}return Object(i.a)(a,[{key:"handleFileCsv",value:function(e){var t=this,a=e.target.files[0],r=new FileReader;r.onloadend=function(){var e=r.result.replace("data:","").replace(/^.+,/,"");console.log(e),t.setState({csv:e})},r.readAsDataURL(a)}},{key:"handleFileSelection",value:function(e){var t=URL.createObjectURL(e.target.files[0]);this.setState({previewImg:t})}},{key:"submitPhoto",value:function(){var e=this,t=localStorage.getItem("user")+(new Date).getTime()+".jpg",a=Object(I.c)(A,t);return Object(I.d)(a,this.fileInput.current.files[0]).then((function(t){Object(I.a)(t.ref).then((function(t){console.log(t),e.setState(Object(h.a)(Object(h.a)({},e.state),{},{product:Object(h.a)(Object(h.a)({},e.state.product),{},{photo:t})})),e.createUser()}))}))}},{key:"handleFieldChange",value:function(e){var t=e.target,a=t.name,r="valor"===a||"stock"===a?parseInt(t.value):t.value;this.setState(Object(h.a)(Object(h.a)({},this.state),{},{product:Object(h.a)(Object(h.a)({},this.state.product),{},Object(k.a)({},a,r))}))}},{key:"createUser",value:function(){var e=this,t=localStorage.getItem("user");if(this.state.product.photo){var a=Object(h.a)(Object(h.a)({},this.state.product),{},{owner:t});if(!Object(P.b)().currentUser)return alert("Sesi\xf3n expirada. Vuelva a loguearse"),void localStorage.clear();Object(P.b)().currentUser.getIdToken(!0).then((function(t){var r=e.state.product._id?{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(a)}:{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(a)},n="https://arq1-meli-grupo-e.herokuapp.com/products";e.state.product._id&&(n=n+"/"+e.state.product._id),fetch(n,r).then((function(t){console.log(t),e.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:null,isLoaded:!0}),e.props.onProductCreated()})).catch((function(t){e.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:t,isLoaded:!0})}))}))}else alert("Debe cargar una imagen del producto para poder publicarlo.")}},{key:"handleSubmit",value:function(e){e.preventDefault(),null!=Object(P.b)().currentUser?(this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1})),this.state.product.photo?this.createUser():this.submitPhoto()):alert("Su sesi\xf3n expir\xf3, vuelva a identificarse")}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,r=this.state.product.photo?Object(S.jsx)("img",{src:this.state.product.photo,className:"imgPreview",alt:"ProductImg"}):null!=this.state.previewImg?Object(S.jsx)("img",{src:this.state.previewImg,className:"imgPreview",alt:"ProductImg"}):Object(S.jsx)("span",{}),n=this.state.product._id?"Actualizar":"Crear producto",s=this.state.product._id?null:Object(S.jsxs)(g.a.Item,{eventKey:"0",children:[Object(S.jsx)(g.a.Header,{children:"Carga masiva de productos"}),Object(S.jsx)(g.a.Body,{children:Object(S.jsxs)("div",{children:[Object(S.jsxs)("label",{children:["Adjunte archivo .csv",Object(S.jsx)("input",{id:"inputCsv",type:"file",accept:".csv",ref:this.csvInput,onChange:this.handleFileCsv})]}),Object(S.jsx)(U.a,{placement:"top",overlay:Object(S.jsx)(F.a,{id:"tooltip-top",children:"Campos a completar categoria,stock,nombre,valor,descripcion(opcional),photo(opcional)"}),children:Object(S.jsx)(B.a,{bg:"info",children:"Info"})}),Object(S.jsxs)("div",{children:["                ",Object(S.jsx)(x.a,{variant:"success",onClick:this.submitCsv,disabled:!this.state.csv,children:"Cargar"})]})]})})]});return t?Object(S.jsxs)("div",{children:["Error: ",t.message]}):a?Object(S.jsxs)(g.a,{children:[s,Object(S.jsxs)(g.a.Item,{eventKey:"1",children:[Object(S.jsx)(g.a.Header,{children:this.state.product._id?"Actualizar":"Crear producto"}),Object(S.jsx)(g.a.Body,{children:Object(S.jsxs)("div",{className:"product-form",children:[Object(S.jsx)("div",{className:"imgSection",children:r}),Object(S.jsxs)("label",{children:["Selecciona una foto del producto:",Object(S.jsx)("input",{type:"file",accept:"image/jpeg",ref:this.fileInput,onChange:this.handleFileSelection})]}),Object(S.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Nombre:",Object(S.jsx)("input",{type:"text",name:"nombre",required:"true",value:this.state.product.nombre,onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Descripci\xf3n:",Object(S.jsx)("textarea",{name:"descripcion",value:this.state.product.descripcion,onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Valor: $",Object(S.jsx)("input",{name:"valor",type:"number",required:"true",value:this.state.product.valor,min:"1",onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Stock:",Object(S.jsx)("input",{name:"stock",type:"number",required:"true",value:this.state.product.stock,min:"1",onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Categoria:",Object(S.jsxs)("select",{name:"categoria",value:this.state.product.categoria,onChange:this.handleFieldChange,children:[Object(S.jsx)("option",{value:"Agro",children:"Agro"}),Object(S.jsx)("option",{value:"Alimentos",children:"Alimentos"}),Object(S.jsx)("option",{value:"Arte",children:"Arte"}),Object(S.jsx)("option",{value:"Colleciones",children:"Colecciones"}),Object(S.jsx)("option",{value:"Deportes",children:"Deportes"}),Object(S.jsx)("option",{value:"Inmuebles",children:"Inmuebles"}),Object(S.jsx)("option",{value:"Mascotas",children:"Mascotas"}),Object(S.jsx)("option",{value:"Tecnologia",children:"T\xe9cnologia"}),Object(S.jsx)("option",{value:"Vehiculos",children:"Veh\xedculos"}),Object(S.jsx)("option",{value:"Vestimenta",children:"Vestimenta"})]})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsx)("button",{type:"submit",title:n,children:n})})]})]})})]})]}):Object(S.jsx)(b.a,{animation:"border",role:"status",children:Object(S.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}}]),a}(n.a.Component),w=(a(106),a.p+"static/media/ml.270e3502.png"),M=(a.p,a(134)),D=a(127),q=a(128),z=a(129),G=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).openCategory=function(e){r.props.onCategory(e.target.name)},r.searchProduct=function(){console.log(r.state.searchTxt),r.props.onSearchProduct(r.state.searchTxt)},r.goToCreation=function(){r.props.onProductCreationEvent()},r.goHome=function(){r.props.onHome()},r.handleLogin=function(){r.props.onLogin()},r.goToRegister=function(){r.props.onRegister()},r.goToUserProducts=function(){r.props.onUserProducts()},r.goToUserSales=function(){r.props.onUserSales()},r.signOut=function(){localStorage.clear(),r.goHome()},r.openCart=function(){r.props.onUserCart()},r.state={searchTxt:""},r.handleSearchChanged=r.handleSearchChanged.bind(Object(u.a)(r)),r}return Object(i.a)(a,[{key:"handleSearchChanged",value:function(e){this.setState({searchTxt:e.target.value})}},{key:"render",value:function(){var e,t,a,r=localStorage.getItem("user"),n=localStorage.getItem("username"),s="true"===localStorage.getItem("seller"),c=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")).length:0,o=Object(S.jsxs)(M.a,{children:[Object(S.jsx)(M.a.Link,{onClick:this.handleLogin,children:" Iniciar sesi\xf3n "}),Object(S.jsx)(M.a.Link,{onClick:this.goToRegister,children:"Registrarme"})]});return null!==r&&(o=Object(S.jsxs)(M.a,{children:[Object(S.jsxs)(M.a.Link,{onClick:this.openCart,children:["Carrito (",c,")"]}),Object(S.jsxs)(M.a.Link,{onClick:this.signOut,children:[n," ,Salir"]})]}),s&&(e=Object(S.jsx)(M.a.Link,{onClick:this.goToCreation,children:"Publicar"}),t=Object(S.jsx)(M.a.Link,{onClick:this.goToUserProducts,children:"Mis productos"}),a=Object(S.jsx)(M.a.Link,{onClick:this.goToUserSales,children:"Mis ventas"}))),Object(S.jsx)(D.a,{variant:"dark",bg:"dark",expand:"lg",children:Object(S.jsxs)(p.a,{fluid:!0,children:[Object(S.jsxs)(D.a.Brand,{href:"",onClick:this.goHome,children:[Object(S.jsx)("img",{alt:"mtLogo",src:w,width:"30",height:"30",className:"d-inline-block align-top"})," ","MercadoTrucho"]}),Object(S.jsx)(D.a.Toggle,{"aria-controls":"navbar-dark-example"}),Object(S.jsxs)(D.a.Collapse,{id:"navbar-dark-example",children:[Object(S.jsxs)(M.a,{children:[e,t,a,Object(S.jsxs)(q.a,{id:"nav-dropdown-dark-example",title:"Categor\xedas",menuVariant:"dark",children:[Object(S.jsx)(q.a.Item,{name:"Agro",onClick:this.openCategory,children:"Agro"}),Object(S.jsx)(q.a.Item,{name:"Alimentos",onClick:this.openCategory,children:"Alimentos"}),Object(S.jsx)(q.a.Item,{name:"Arte",onClick:this.openCategory,children:"Arte"}),Object(S.jsx)(q.a.Item,{name:"Colleciones",onClick:this.openCategory,children:"Colecciones"}),Object(S.jsx)(q.a.Item,{name:"Deportes",onClick:this.openCategory,children:"Deportes"}),Object(S.jsx)(q.a.Item,{name:"Inmuebles",onClick:this.openCategory,children:"Inmuebles"}),Object(S.jsx)(q.a.Item,{name:"Mascotas",onClick:this.openCategory,children:"Mascotas"}),Object(S.jsx)(q.a.Item,{name:"Tecnologia",onClick:this.openCategory,children:"T\xe9cnologia"}),Object(S.jsx)(q.a.Item,{name:"Vehiculos",onClick:this.openCategory,children:"Veh\xedculos"}),Object(S.jsx)(q.a.Item,{name:"Vestimenta",onClick:this.openCategory,children:"Vestimenta"})]})]}),Object(S.jsxs)(z.a,{className:"d-flex",children:[Object(S.jsx)(m.a,{type:"search",placeholder:"Buscar",className:"me-2","aria-label":"Search",onChange:this.handleSearchChanged}),Object(S.jsx)(x.a,{variant:"outline-success",onClick:this.searchProduct,children:"Buscar"})]}),o]})]})})}}]),a}(n.a.Component),_=(a(109),a(110),a.p+"static/media/google-logo.0590aaf0.png"),R=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).state={error:null,isLoaded:!0,screen:"auth",token:null,user:{nombre:"",apellido:"",username:"",seller:!1,email:"",razonSocial:"",emailCorporativo:"",uid:""}},r.handleFieldChange=r.handleFieldChange.bind(Object(u.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(u.a)(r)),r.handleGoogleSignIn=r.handleGoogleSignIn.bind(Object(u.a)(r)),r}return Object(i.a)(a,[{key:"handleGoogleSignIn",value:function(e){var t=this,a=new P.a,r=Object(P.b)();Object(P.c)(r,a).then((function(e){P.a.credentialFromResult(e);var a=e.user;a.getIdToken(!0).then((function(e){t.setState(Object(h.a)(Object(h.a)({},t.state),{},{token:e,screen:"form",user:Object(h.a)(Object(h.a)({},t.state.user),{},{uid:a.uid,nombre:a.displayName.split(" ")[0],email:a.email})}))}))})).catch((function(e){e.code,e.message,e.email,P.a.credentialFromError(e)}))}},{key:"handleFieldChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,r=t.name;this.setState(Object(h.a)(Object(h.a)({},this.state),{},{user:Object(h.a)(Object(h.a)({},this.state.user),{},Object(k.a)({},r,a))}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1}));var a={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"http://localhost:3000",Authorization:"Bearer "+this.state.token},body:JSON.stringify(this.state.user)};fetch("https://arq1-meli-grupo-e.herokuapp.com/users",a).then((function(e){console.log(e.status),t.setState({user:{nombre:"",apellido:"",username:"",seller:!1,email:"",razonSocial:"",emailCorporativo:""},error:null,isLoaded:!0}),200===e.status?t.props.onUserCreated():403===e.status?alert("Error en la autenticaci\xf3n"):303===e.status?alert("Usuario ya registrado"):400===e.status?alert("Error en el ingreso de campos"):alert("Ocurri\xf3 un error en el registro. Por favor intente nuevamente: "+e.statusText)})).catch((function(e){t.setState({user:{nombre:"",apellido:"",username:"",password:"",seller:!1,email:"",razonSocial:"",emailCorporativo:""},error:e,isLoaded:!0}),alert("Ocurri\xf3 un error en el registro. Por favor intente nuevamente ")}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,r=e.user,n=Object(P.b)().currentUser;console.log(n);var s=Object(S.jsx)("br",{});return n&&n.displayName,r.seller&&(s=Object(S.jsxs)("div",{children:[Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Raz\xf3n Social:",Object(S.jsx)("input",{type:"text",name:"razonSocial",value:r.razonSocial,onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Mail Corporativo:",Object(S.jsx)("input",{name:"emailCorporativo",type:"email",value:r.emailCorporativo,onChange:this.handleFieldChange})]})})]})),t?Object(S.jsxs)("div",{children:["Error: ",t.message]}):a?"auth"===this.state.screen?Object(S.jsxs)(p.a,{className:"registerContainer",children:[Object(S.jsx)("img",{src:_,width:"150px"})," ",Object(S.jsx)("br",{})," ",Object(S.jsx)("br",{}),Object(S.jsx)(x.a,{onClick:this.handleGoogleSignIn,children:"Registrarme con Google"})]}):Object(S.jsx)("div",{className:"product-form",children:Object(S.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Nombre:",Object(S.jsx)("input",{type:"text",name:"nombre",value:r.nombre,onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Apellido:",Object(S.jsx)("input",{type:"text",name:"apellido",value:r.apellido,onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Nombre de usuario:",Object(S.jsx)("input",{type:"text",name:"username",value:r.username,onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Mail:",Object(S.jsx)("input",{name:"email",type:"email",value:r.email,onChange:this.handleFieldChange})]})}),Object(S.jsx)("div",{className:"form-field",children:Object(S.jsxs)("label",{children:["Es vendedor?:",Object(S.jsx)("input",{type:"checkbox",name:"seller",checked:r.seller,onChange:this.handleFieldChange})]})}),s,Object(S.jsx)("div",{className:"form-field",children:Object(S.jsx)("button",{type:"submit",children:"Terminar registro"})})]})}):Object(S.jsx)("div",{children:"Cargando..."})}}]),a}(n.a.Component),V=(a(111),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).state={error:null,isLoaded:!0,user:{username:"",password:""}},r.handleGoogleSignIn=r.handleGoogleSignIn.bind(Object(u.a)(r)),r}return Object(i.a)(a,[{key:"handleGoogleSignIn",value:function(e){var t=this;this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1}));var a=new P.a,r=Object(P.b)();Object(P.c)(r,a).then((function(e){P.a.credentialFromResult(e);e.user.getIdToken(!0).then((function(e){var a={method:"GET",headers:{Authorization:"Bearer "+e,Accept:"application/json"}};console.log(e),fetch("https://arq1-meli-grupo-e.herokuapp.com/users/login",a).then((function(e){return console.log(e.status),403===e.status?(alert("Autenticaci\xf3n inv\xe1lida"),null):404===e.status?(alert("Usuario no registrado. Por favor, proceda a realizar el registro de su cuenta"),null):e.json()})).then((function(e){console.log(e),e?(t.setState({error:null,isLoaded:!0}),localStorage.setItem("user",e._id),localStorage.setItem("username",e.username),localStorage.setItem("seller",e.seller.toString()),t.props.onUserLogin()):(t.setState({isLoaded:!0}),alert("Ocurri\xf3 un error en el ingreso. Por favor intente nuevamente"))})).catch((function(e){t.setState({error:e,isLoaded:!0}),console.log(JSON.stringify(e)),alert("Ocurri\xf3 un error en el ingreso Por favor intente nuevamente ")}))})).catch((function(e){}))})).catch((function(e){e.code;var t=e.message;e.email,P.a.credentialFromError(e);alert(t)}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded;e.user;return t?Object(S.jsxs)("div",{children:["Error: ",t.message]}):a?Object(S.jsxs)("div",{className:"loginSection",children:[Object(S.jsx)("img",{src:_,width:"100px"}),Object(S.jsx)("br",{}),Object(S.jsx)("br",{}),Object(S.jsx)(x.a,{onClick:this.handleGoogleSignIn,variant:"success",children:"Iniciar sesi\xf3n con Google"})]}):Object(S.jsx)("div",{children:"Cargando..."})}}]),a}(n.a.Component)),J=(a(112),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).handleDelete=function(e){r.setState(Object(h.a)(Object(h.a)({},r.state),{},{isLoaded:!1})),Object(P.b)().currentUser.getIdToken(!0).then((function(t){fetch("https://arq1-meli-grupo-e.herokuapp.com/products/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+t}}).then((function(e){console.log(e),r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:null,isLoaded:!0})),r.componentDidMount()})).catch((function(e){r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:e,isLoaded:!0}))}))}))},r.handleEdit=function(e){r.props.onProductEdit(e)},r.state={error:null,isLoaded:!1,items:[]},r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;null!=Object(P.b)().currentUser?Object(P.b)().currentUser.getIdToken(!0).then((function(t){var a={method:"GET",headers:{Authorization:"Bearer "+t}};fetch("https://arq1-meli-grupo-e.herokuapp.com/products/"+localStorage.getItem("user"),a).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoaded:!0,items:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))})):alert("Su sesi\xf3n expir\xf3, vuelva a identificarse")}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,r=t.isLoaded,n=t.items;return a?Object(S.jsxs)("div",{children:["Error: ",a.message]}):r?Object(S.jsx)(p.a,{fluid:"lg",style:{padding:"1%"},children:Object(S.jsx)(v.a,{children:n.map((function(t){return Object(S.jsx)(f.a,{children:Object(S.jsxs)(C.a,{style:{width:"18rem",height:"500px"},children:[Object(S.jsx)(C.a.Img,{variant:"top",src:t.photo}),Object(S.jsxs)(C.a.Body,{children:[Object(S.jsx)(C.a.Title,{children:t.nombre}),Object(S.jsx)(C.a.Text,{children:t.descripcion})]}),Object(S.jsxs)(C.a.Text,{children:["$ ",t.valor]}),Object(S.jsx)(C.a.Link,{onClick:function(){e.handleDelete(t._id)},children:"Eliminar"}),Object(S.jsx)(C.a.Link,{onClick:function(){e.handleEdit(t)},children:"Editar"})]})},t._id)}))})}):Object(S.jsx)("div",{children:"Cargando..."})}}]),a}(n.a.Component)),H=(a(113),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).addToCart=function(){var e,t=localStorage.getItem("cart"),a={cantidad:r.state.amount,product:r.state.product};t?(e=JSON.parse(t)).push(a):e=[a],localStorage.setItem("cart",JSON.stringify(e)),alert("Elemento agregado al carrito")},r.purchaseProduct=function(){var e=localStorage.getItem("user"),t={products:[{productId:r.state.product._id,cantidadProductos:r.state.amount}],costoTotal:r.state.product.valor*r.state.amount,buyer:e,formaPago:r.state.formaPago};console.log(t),Object(P.b)().currentUser.getIdToken(!0).then((function(e){var a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(t)};fetch("https://arq1-meli-grupo-e.herokuapp.com/sales",a).then((function(e){console.log(e),200==e.status?(r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:null,isLoaded:!0})),r.props.onSellCreated()):(alert(e.statusText),r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:e.statusText,isLoaded:!0})))})).catch((function(e){console.log(e),r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:e,isLoaded:!0}))}))}))},r.state={error:null,isLoaded:!1,product:{},amount:1,formaPago:"Cash"},r.handleChangeAmount=r.handleChangeAmount.bind(Object(u.a)(r)),r.handlePaymentChanged=r.handlePaymentChanged.bind(Object(u.a)(r)),r}return Object(i.a)(a,[{key:"handleChangeAmount",value:function(e){this.setState(Object(h.a)(Object(h.a)({},this.state),{},{amount:e.target.value}))}},{key:"handlePaymentChanged",value:function(e){this.setState(Object(h.a)(Object(h.a)({},this.state),{},{formaPago:e.target.value})),console.log(e.target.value)}},{key:"componentDidMount",value:function(){var e=this,t=this.props.productId;this.setState({isLoaded:!1}),fetch("https://arq1-meli-grupo-e.herokuapp.com/product/"+t).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoaded:!0,product:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){return this.state.isLoaded?Object(S.jsx)(p.a,{children:Object(S.jsxs)(C.a,{className:"text-center",children:[Object(S.jsx)(C.a.Header,{children:this.state.product.nombre}),Object(S.jsx)(C.a.Img,{variant:"top",className:"productImg",src:this.state.product.photo}),Object(S.jsxs)(C.a.Body,{children:[Object(S.jsxs)(C.a.Title,{children:["$ ",this.state.product.valor]}),Object(S.jsx)(C.a.Text,{children:this.state.product.descripcion}),Object(S.jsxs)(O.a,{className:"mb-3",children:[Object(S.jsx)(O.a.Text,{id:"basic-addon1",children:"Cantidad a comprar: "}),Object(S.jsx)(m.a,{placeholder:"0","aria-label":"0","aria-describedby":"basic-addon1",type:"number",min:"1",max:this.state.product.stock,value:this.state.amount,onChange:this.handleChangeAmount}),Object(S.jsxs)(z.a.Select,{"aria-label":"Medio de pago",onChange:this.handlePaymentChanged,defaultValue:"Cash",children:[Object(S.jsx)("option",{children:"-No seleccionado-"}),Object(S.jsx)("option",{value:"Cash",children:"Efectivo"}),Object(S.jsx)("option",{value:"Card",children:"Tarjeta"}),Object(S.jsx)("option",{value:"MercadoPago",children:"MercadoPago"}),Object(S.jsx)("option",{value:"Transferencia",children:"Transferencia"}),Object(S.jsx)("option",{value:"Otros",children:"Otros"})]})]}),Object(S.jsx)(x.a,{variant:"success",onClick:this.addToCart,children:"Agregar al carrito"}),Object(S.jsx)(x.a,{variant:"primary",onClick:this.purchaseProduct,children:"Comprar"})]}),Object(S.jsxs)(C.a.Footer,{className:"text-muted",children:[" Quedan disponibles: ",this.state.product.stock-this.state.amount]})]})}):Object(S.jsx)(b.a,{animation:"border",role:"status",children:Object(S.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}}]),a}(n.a.Component)),$=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).state={error:null,isLoaded:!1,sells:[]},r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getProducts()}},{key:"getProducts",value:function(){var e=this,t="?seller="+localStorage.getItem("user");console.log(t),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1})),Object(P.b)().currentUser.getIdToken(!0).then((function(a){fetch("https://arq1-meli-grupo-e.herokuapp.com/sales"+t,{method:"GET",headers:{Authorization:"Bearer "+a}}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoaded:!0,sells:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,r=e.sells;localStorage.getItem("user");return t?Object(S.jsxs)("div",{"data-testid":"Listado",children:["Error: ",t.message]}):a?Object(S.jsx)(p.a,{children:Object(S.jsx)(v.a,{children:r.map((function(e){return Object(S.jsx)(f.a,{children:Object(S.jsxs)(C.a,{style:{width:"18rem",minHeight:"400px"},children:[Object(S.jsx)(C.a.Body,{children:Object(S.jsxs)(C.a.Title,{children:["Venta ",e._id]})}),e.wrapperProduct.map((function(e){return Object(S.jsxs)(C.a.Text,{children:[Object(S.jsxs)("p",{children:["Producto: ",e.nombre]})," ",Object(S.jsxs)("p",{children:["Valor: ",e.valor]})]})})),Object(S.jsxs)(C.a.Text,{children:[" Fecha ",new Date(e.createdAt).toLocaleString()]}),Object(S.jsxs)(C.a.Text,{children:[" Comprado por ",e.buyer.username]}),Object(S.jsxs)(C.a.Text,{children:["M\xe9todo de pago: ",e.formaPago]}),Object(S.jsxs)(C.a.Text,{children:["$ ",e.costoTotal]})]})},e._id)}))})}):Object(S.jsx)("div",{"data-testid":"Listado",children:"Cargando..."})}}]),a}(n.a.Component),K=a(135),Q=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).purchaseProducts=function(){var e=localStorage.getItem("user"),t={products:JSON.parse(localStorage.getItem("cart")).map((function(e){return{cantidadProductos:e.cantidad,productId:e.product._id}})),costoTotal:r.state.cart.reduce((function(e,t){return e+t.cantidad*t.product.valor}),0),buyer:e,formaPago:r.state.formaPago};r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:null,isLoaded:!1})),Object(P.b)().currentUser.getIdToken(!0).then((function(e){var a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(t)};console.log(a.body);fetch("https://arq1-meli-grupo-e.herokuapp.com/sales",a).then((function(e){console.log(e),200==e.status?(r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:null,isLoaded:!0})),r.props.onSellCreated()):(alert(e.statusText),r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:e.statusText,isLoaded:!0})))})).catch((function(e){console.log(JSON.stringify(e)),alert("Ocurri\xf3 un error al realizar la compra"),r.setState(Object(h.a)(Object(h.a)({},r.state),{},{error:e,isLoaded:!0}))}))}))},r.state={error:null,isLoaded:!1,cart:[],formaPago:"Cash"},r.handlePaymentChanged=r.handlePaymentChanged.bind(Object(u.a)(r)),r}return Object(i.a)(a,[{key:"handlePaymentChanged",value:function(e){this.setState(Object(h.a)(Object(h.a)({},this.state),{},{formaPago:e.target.value})),console.log(e.target.value)}},{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("cart"));this.setState({isLoaded:!0,cart:e})}},{key:"render",value:function(){return this.state.isLoaded?this.state.cart?Object(S.jsx)(p.a,{children:Object(S.jsxs)(C.a,{className:"text-center",children:[Object(S.jsx)(C.a.Header,{children:"Tu carrito"}),Object(S.jsxs)(C.a.Body,{children:[Object(S.jsx)(K.a,{variant:"flush",children:this.state.cart.map((function(e){return Object(S.jsx)(K.a.Item,{children:Object(S.jsxs)(v.a,{children:[Object(S.jsxs)(f.a,{children:[Object(S.jsxs)("p",{children:["Producto: ",e.product.nombre]}),Object(S.jsxs)("p",{children:["Precio por unidad: $",e.product.valor]})]}),Object(S.jsx)(f.a,{children:Object(S.jsxs)("p",{children:["Cantidad: ",e.cantidad]})})]})},e.product._id)}))}),Object(S.jsxs)(C.a.Text,{children:["Total: $",this.state.cart.reduce((function(e,t){return e+t.cantidad*t.product.valor}),0)]}),Object(S.jsx)(O.a,{className:"mb-3",children:Object(S.jsxs)(z.a.Select,{"aria-label":"Medio de pago",onChange:this.handlePaymentChanged,defaultValue:"Cash",children:[Object(S.jsx)("option",{children:"-No seleccionado-"}),Object(S.jsx)("option",{value:"Cash",children:"Efectivo"}),Object(S.jsx)("option",{value:"Card",children:"Tarjeta"}),Object(S.jsx)("option",{value:"MercadoPago",children:"MercadoPago"}),Object(S.jsx)("option",{value:"Transferencia",children:"Transferencia"}),Object(S.jsx)("option",{value:"Otros",children:"Otros"})]})}),Object(S.jsx)(x.a,{variant:"primary",onClick:this.purchaseProducts,children:"Comprar"})]})]})}):Object(S.jsx)(p.a,{children:Object(S.jsxs)(C.a,{className:"text-center",id:"emptyCart",children:[Object(S.jsx)(C.a.Header,{children:"Su carrito es\xe1 vac\xedo"}),Object(S.jsx)(C.a.Body,{})]})}):Object(S.jsx)(b.a,{animation:"border",role:"status",children:Object(S.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}}]),a}(n.a.Component),Y=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).handleSearchCategory=function(e){r.setState({screen:"list",category:e,searchText:null})},r.handleSearchProduct=function(e){r.setState({screen:"list",searchText:e,category:null})},r.handleProductCreation=function(){alert("Producto Creado")},r.handleLogin=function(){r.setState({screen:"list"})},r.handleUserLogin=function(){r.setState({screen:"login"})},r.handleCreationScreen=function(){r.setState({screen:"createProduct"})},r.handleProductEdit=function(e){r.setState({screen:"editProduct",product:e})},r.handleProductBuy=function(e){r.setState({screen:"productInfo",product:e})},r.handleSellCreated=function(){alert("Compra realizada con \xe9xito!"),localStorage.removeItem("cart"),r.setState({screen:"list"})},r.handleHomeScreen=function(){r.setState({screen:"list"})},r.handleRegisterScreen=function(){r.setState({screen:"createUser"})},r.handleUserProductsScreen=function(){r.setState({screen:"userProducts"})},r.handleUserSales=function(){r.setState({screen:"userSales"})},r.handleUserCart=function(){r.setState({screen:"userCart"})},r.state={screen:"list"},r}return Object(i.a)(a,[{key:"render",value:function(){var e;switch(this.state.screen){case"createProduct":e=Object(S.jsx)(E,{onProductCreated:this.handleProductCreation});break;case"createUser":e=Object(S.jsx)(R,{onUserCreated:this.handleHomeScreen});break;case"list":e=Object(S.jsx)(y,{search:this.state.searchText,category:this.state.category,onProductBuy:this.handleProductBuy});break;case"userProducts":e=Object(S.jsx)(J,{onProductEdit:this.handleProductEdit});break;case"editProduct":e=Object(S.jsx)(E,{onProductCreated:this.handleProductCreation,product:this.state.product});break;case"productInfo":e=Object(S.jsx)(H,{productId:this.state.product,onSellCreated:this.handleSellCreated});break;case"userSales":e=Object(S.jsx)($,{});break;case"userCart":e=Object(S.jsx)(Q,{onSellCreated:this.handleSellCreated});break;default:e=Object(S.jsx)(V,{onUserLogin:this.handleLogin})}return Object(S.jsxs)("div",{className:"App","data-testid":"App",children:[Object(S.jsx)(G,{onProductCreationEvent:this.handleCreationScreen,onLogin:this.handleUserLogin,onHome:this.handleHomeScreen,onRegister:this.handleRegisterScreen,onUserProducts:this.handleUserProductsScreen,onCategory:this.handleSearchCategory,onSearchProduct:this.handleSearchProduct,onUserSales:this.handleUserSales,onUserCart:this.handleUserCart}),e]})}}]),a}(n.a.Component),X=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,136)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),r(e),n(e),s(e),c(e)}))};a(114);c.a.render(Object(S.jsx)(n.a.StrictMode,{children:Object(S.jsx)(Y,{})}),document.getElementById("root")),X()}},[[115,1,2]]]);
//# sourceMappingURL=main.c5f59bae.chunk.js.map