(this.webpackJsonpmercado_trucho=this.webpackJsonpmercado_trucho||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){},102:function(e,t,a){},103:function(e,t,a){},105:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(35),o=a.n(s),c=(a(90),a(7)),i=a(8),l=a(13),d=a(14),h=a(4),u=a(16),j=a(111),b=a(118),p=a(112),g=a(77),m=a(47),O=a(113),f=a(78),x=a(120),v=a(2),C=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleBuy=function(e){n.props.onProductBuy(e)},n.state={error:null,isLoaded:!1,products:[],gte:0,lte:0},n.filterProducts=n.filterProducts.bind(Object(u.a)(n)),n.handleChangeGte=n.handleChangeGte.bind(Object(u.a)(n)),n.handleChangeLte=n.handleChangeLte.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"handleChangeGte",value:function(e){var t=e.target,a=parseInt(t.value);this.setState(Object(h.a)(Object(h.a)({},this.state),{},{gte:a}))}},{key:"handleChangeLte",value:function(e){var t=e.target,a=parseInt(t.value);this.setState(Object(h.a)(Object(h.a)({},this.state),{},{lte:a}))}},{key:"getSnapshotBeforeUpdate",value:function(e){return{notifyRequired:e.search!==this.props.search||e.category!==this.props.category}}},{key:"componentDidUpdate",value:function(e,t,a){if(a.notifyRequired){var n=[];null!=this.props.category&&n.push("categoria="+this.props.category),null!=this.props.search&&n.push("nombre="+this.props.search),null!=this.state.lte&&0!=this.state.lte&&n.push("lte="+this.state.lte),null!=this.state.gte&&0!=this.state.gte&&n.push("gte="+this.state.gte),n.length>0&&(n=n.join("&"),this.getProducts(n))}}},{key:"componentDidMount",value:function(){var e=[];null!=this.props.category&&e.push("categoria="+this.props.category),null!=this.state.lte&&0!=this.state.lte&&e.push("lte="+this.state.lte),null!=this.state.gte&&0!=this.state.gte&&e.push("gte="+this.state.gte),null!=this.props.search&&e.push("nombre="+this.props.search),e.length>0&&(e=e.join("&"),this.getProducts(e)),this.getProducts()}},{key:"filterProducts",value:function(){var e=[];null!=this.state.lte&&0!=this.state.lte&&e.push("lte="+this.state.lte),null!=this.state.gte&&0!=this.state.gte&&e.push("gte="+this.state.gte),e.length>0&&(this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1})),e=e.join("&"),this.getProducts(e))}},{key:"getProducts",value:function(e){var t=this,a="";e&&(a="?"+e),console.log(a),fetch("https://arq1-meli-grupo-e.herokuapp.com/products"+a).then((function(e){return e.json()})).then((function(e){console.log(e),t.setState({isLoaded:!0,items:e})}),(function(e){t.setState({isLoaded:!0,error:e})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,n=t.isLoaded,r=t.items,s=localStorage.getItem("user");localStorage.getItem("username");return a?Object(v.jsxs)("div",{"data-testid":"Listado",children:["Error: ",a.message]}):n?Object(v.jsxs)(j.a,{fluid:"lg",style:{padding:"1%"},"data-testid":"Listado",children:[Object(v.jsx)(b.a,{defaultActiveKey:"",children:Object(v.jsxs)(b.a.Item,{eventKey:"0",children:[Object(v.jsx)(b.a.Header,{children:"Filtrar resultado"}),Object(v.jsxs)(b.a.Body,{children:[Object(v.jsxs)(p.a,{className:"mb-3",children:[Object(v.jsx)(p.a.Text,{id:"basic-addon1",children:"Valor mayor a: "}),Object(v.jsx)(g.a,{placeholder:"0","aria-label":"0","aria-describedby":"basic-addon1",type:"number",value:this.state.gte,onChange:this.handleChangeGte})]}),Object(v.jsxs)(p.a,{className:"mb-3",children:[Object(v.jsx)(p.a.Text,{id:"basic-addon2",children:"Valor menor a: "}),Object(v.jsx)(g.a,{placeholder:"0","aria-label":"0","aria-describedby":"basic-addon2",type:"number",value:this.state.lte,onChange:this.handleChangeLte})]}),Object(v.jsx)(m.a,{variant:"success",onClick:this.filterProducts,children:"Filtrar"})]})]})}),Object(v.jsx)(O.a,{children:r.map((function(t){return Object(v.jsx)(f.a,{children:Object(v.jsxs)(x.a,{style:{width:"18rem",height:"500px"},children:[Object(v.jsx)(x.a.Img,{variant:"top",src:t.photo}),Object(v.jsx)(x.a.Body,{children:Object(v.jsx)(x.a.Title,{children:t.nombre})}),Object(v.jsxs)(x.a.Text,{children:["Cantidad disponible: ",t.stock]}),Object(v.jsxs)(x.a.Text,{children:["$ ",t.valor]}),Object(v.jsx)(m.a,{variant:"primary",onClick:function(){e.handleBuy(t._id)},disabled:null==s,children:"Comprar"})]})},t._id)}))})]}):Object(v.jsx)("div",{"data-testid":"Listado",children:"Cargando..."})}}]),a}(r.a.Component),S=a(3),y=(a(94),a(18)),k=a(53),P=a(79),I=a(84),L=Object(P.a)({apiKey:"AIzaSyBVwJk4DI_k64X4sTyoFcG6uxvI_qnJk-Q",authDomain:"unq-arq-soft-1-grupo-e.firebaseapp.com",projectId:"unq-arq-soft-1-grupo-e",storageBucket:"unq-arq-soft-1-grupo-e.appspot.com",messagingSenderId:"1064909149315",appId:"1:1064909149315:web:42677b0348548404f2f7b6",measurementId:"G-MLY1S1NYFG"}),T=(Object(I.a)(L),Object(k.b)(L)),N=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={previewImg:null,error:null,isLoaded:!0,product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"}},n.fileInput=r.a.createRef(),n.handleFileSelection=n.handleFileSelection.bind(Object(u.a)(n)),n.props.product&&(n.state=Object(h.a)(Object(h.a)({},n.state),{},{product:n.props.product})),n.handleFieldChange=n.handleFieldChange.bind(Object(u.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"handleFileSelection",value:function(e){var t=URL.createObjectURL(e.target.files[0]);this.setState({previewImg:t})}},{key:"submitPhoto",value:function(){var e=this,t=localStorage.getItem("user")+(new Date).getTime()+".jpg",a=Object(k.c)(T,t);return Object(k.d)(a,this.fileInput.current.files[0]).then((function(t){Object(k.a)(t.ref).then((function(t){console.log(t),e.setState(Object(h.a)(Object(h.a)({},e.state),{},{product:Object(h.a)(Object(h.a)({},e.state.product),{},{photo:t})})),e.createUser()}))}))}},{key:"handleFieldChange",value:function(e){var t=e.target,a=t.name,n="valor"===a||"stock"===a?parseInt(t.value):t.value;this.setState(Object(h.a)(Object(h.a)({},this.state),{},{product:Object(h.a)(Object(h.a)({},this.state.product),{},Object(S.a)({},a,n))}))}},{key:"createUser",value:function(){var e=this,t=localStorage.getItem("user");if(this.state.product.photo){var a=Object(h.a)(Object(h.a)({},this.state.product),{},{owner:t});Object(y.b)().currentUser.getIdToken(!0).then((function(t){var n=e.state.product._id?{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(a)}:{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify(a)},r="https://arq1-meli-grupo-e.herokuapp.com/products";e.state.product._id&&(r=r+"/"+e.state.product._id),fetch(r,n).then((function(t){console.log(t),e.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:null,isLoaded:!0}),e.props.onProductCreated()})).catch((function(t){e.setState({product:{nombre:"",descripcion:"",valor:0,stock:1,categoria:"Agro"},error:t,isLoaded:!0})}))}))}else alert("Debe cargar una imagen del producto para poder publicarlo.")}},{key:"handleSubmit",value:function(e){e.preventDefault(),null!=Object(y.b)().currentUser?(this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1})),this.state.product.photo?this.createUser():this.submitPhoto()):alert("Su sesi\xf3n expir\xf3, vuelva a identificarse")}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,n=this.state.product.photo?Object(v.jsx)("img",{src:this.state.product.photo,className:"imgPreview",alt:"ProductImg"}):null!=this.state.previewImg?Object(v.jsx)("img",{src:this.state.previewImg,className:"imgPreview",alt:"ProductImg"}):Object(v.jsx)("span",{}),r=this.state.product._id?"Actualizar":"Crear producto";return t?Object(v.jsxs)("div",{children:["Error: ",t.message]}):a?Object(v.jsxs)("div",{className:"product-form",children:[Object(v.jsx)("div",{className:"imgSection",children:n}),Object(v.jsxs)("label",{children:["Selecciona una foto del producto:",Object(v.jsx)("input",{type:"file",accept:"image/jpeg",ref:this.fileInput,onChange:this.handleFileSelection})]}),Object(v.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Nombre:",Object(v.jsx)("input",{type:"text",name:"nombre",required:"true",value:this.state.product.nombre,onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Descripci\xf3n:",Object(v.jsx)("textarea",{name:"descripcion",value:this.state.product.descripcion,onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Valor: $",Object(v.jsx)("input",{name:"valor",type:"number",required:"true",value:this.state.product.valor,min:"1",onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Stock:",Object(v.jsx)("input",{name:"stock",type:"number",required:"true",value:this.state.product.stock,min:"1",onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Categoria:",Object(v.jsxs)("select",{name:"categoria",value:this.state.product.categoria,onChange:this.handleFieldChange,children:[Object(v.jsx)("option",{value:"Agro",children:"Agro"}),Object(v.jsx)("option",{value:"Alimentos",children:"Alimentos"}),Object(v.jsx)("option",{value:"Arte",children:"Arte"}),Object(v.jsx)("option",{value:"Colleciones",children:"Colecciones"}),Object(v.jsx)("option",{value:"Deportes",children:"Deportes"}),Object(v.jsx)("option",{value:"Inmuebles",children:"Inmuebles"}),Object(v.jsx)("option",{value:"Mascotas",children:"Mascotas"}),Object(v.jsx)("option",{value:"Tecnologia",children:"T\xe9cnologia"}),Object(v.jsx)("option",{value:"Vehiculos",children:"Veh\xedculos"}),Object(v.jsx)("option",{value:"Vestimenta",children:"Vestimenta"})]})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsx)("button",{type:"submit",title:r,children:r})})]})]}):Object(v.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component),A=(a(96),a.p+"static/media/ml.270e3502.png"),F=(a.p,a(119)),U=a(116),E=a(115),B=a(117),w=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).openCategory=function(e){console.log(e.target.name),n.props.onCategory(e.target.name)},n.searchProduct=function(){console.log(n.state.searchTxt),n.props.onSearchProduct(n.state.searchTxt)},n.goToCreation=function(){n.props.onProductCreationEvent()},n.goHome=function(){n.props.onHome()},n.handleLogin=function(){n.props.onLogin()},n.goToRegister=function(){n.props.onRegister()},n.goToUserProducts=function(){n.props.onUserProducts()},n.signOut=function(){localStorage.removeItem("user"),n.goHome()},n.state={searchTxt:""},n.handleSearchChanged=n.handleSearchChanged.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"handleSearchChanged",value:function(e){this.setState({searchTxt:e.target.value})}},{key:"render",value:function(){var e,t,a=localStorage.getItem("user"),n=localStorage.getItem("username"),r="true"===localStorage.getItem("seller"),s=Object(v.jsxs)(F.a,{children:[Object(v.jsx)(F.a.Link,{onClick:this.handleLogin,children:" Iniciar sesi\xf3n "}),Object(v.jsx)(F.a.Link,{onClick:this.goToRegister,children:"Registrarme"})]});return null!==a&&(s=Object(v.jsx)(F.a,{children:Object(v.jsxs)(F.a.Link,{onClick:this.signOut,children:[n," ,Salir"]})}),r&&(e=Object(v.jsx)(F.a.Link,{onClick:this.goToCreation,children:"Publicar"}),t=Object(v.jsx)(F.a.Link,{onClick:this.goToUserProducts,children:"Mis productos"}))),Object(v.jsx)(U.a,{variant:"dark",bg:"dark",expand:"lg",children:Object(v.jsxs)(j.a,{fluid:!0,children:[Object(v.jsxs)(U.a.Brand,{href:"/",children:[Object(v.jsx)("img",{alt:"mtLogo",src:A,width:"30",height:"30",className:"d-inline-block align-top"})," ","MercadoTrucho"]}),Object(v.jsx)(U.a.Toggle,{"aria-controls":"navbar-dark-example"}),Object(v.jsxs)(U.a.Collapse,{id:"navbar-dark-example",children:[Object(v.jsxs)(F.a,{children:[Object(v.jsx)(F.a.Link,{children:"M\xe1s vendidos"}),e,t,Object(v.jsxs)(E.a,{id:"nav-dropdown-dark-example",title:"Categor\xedas",menuVariant:"dark",children:[Object(v.jsx)(E.a.Item,{name:"Agro",onClick:this.openCategory,children:"Agro"}),Object(v.jsx)(E.a.Item,{name:"Alimentos",onClick:this.openCategory,children:"Alimentos"}),Object(v.jsx)(E.a.Item,{name:"Arte",onClick:this.openCategory,children:"Arte"}),Object(v.jsx)(E.a.Item,{name:"Colleciones",onClick:this.openCategory,children:"Colecciones"}),Object(v.jsx)(E.a.Item,{name:"Deportes",onClick:this.openCategory,children:"Deportes"}),Object(v.jsx)(E.a.Item,{name:"Inmuebles",onClick:this.openCategory,children:"Inmuebles"}),Object(v.jsx)(E.a.Item,{name:"Mascotas",onClick:this.openCategory,children:"Mascotas"}),Object(v.jsx)(E.a.Item,{name:"Tecnologia",onClick:this.openCategory,children:"T\xe9cnologia"}),Object(v.jsx)(E.a.Item,{name:"Vehiculos",onClick:this.openCategory,children:"Veh\xedculos"}),Object(v.jsx)(E.a.Item,{name:"Vestimenta",onClick:this.openCategory,children:"Vestimenta"})]})]}),Object(v.jsxs)(B.a,{className:"d-flex",children:[Object(v.jsx)(g.a,{type:"search",placeholder:"Buscar",className:"me-2","aria-label":"Search",onChange:this.handleSearchChanged}),Object(v.jsx)(m.a,{variant:"outline-success",onClick:this.searchProduct,children:"Buscar"})]}),s]})]})})}}]),a}(r.a.Component),q=(a(99),a(100),a.p+"static/media/google-logo.0590aaf0.png"),D=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={error:null,isLoaded:!0,screen:"auth",token:null,user:{nombre:"",apellido:"",username:"",seller:!1,email:"",razonSocial:"",emailCorporativo:"",uid:""}},n.handleFieldChange=n.handleFieldChange.bind(Object(u.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(u.a)(n)),n.handleGoogleSignIn=n.handleGoogleSignIn.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"handleGoogleSignIn",value:function(e){var t=this,a=new y.a,n=Object(y.b)();Object(y.c)(n,a).then((function(e){y.a.credentialFromResult(e);var a=e.user;a.getIdToken(!0).then((function(e){t.setState(Object(h.a)(Object(h.a)({},t.state),{},{token:e,screen:"form",user:Object(h.a)(Object(h.a)({},t.state.user),{},{uid:a.uid,nombre:a.displayName.split(" ")[0],email:a.email})}))}))})).catch((function(e){e.code,e.message,e.email,y.a.credentialFromError(e)}))}},{key:"handleFieldChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(h.a)(Object(h.a)({},this.state),{},{user:Object(h.a)(Object(h.a)({},this.state.user),{},Object(S.a)({},n,a))}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1}));var a={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"http://localhost:3000",Authorization:"Bearer "+this.state.token},body:JSON.stringify(this.state.user)};fetch("https://arq1-meli-grupo-e.herokuapp.com/users",a).then((function(e){console.log(e.status),t.setState({user:{nombre:"",apellido:"",username:"",seller:!1,email:"",razonSocial:"",emailCorporativo:""},error:null,isLoaded:!0}),200===e.status?t.props.onUserCreated():403===e.status?alert("Error en la autenticaci\xf3n"):303===e.status?alert("Usuario ya registrado"):400===e.status?alert("Error en el ingreso de campos"):alert("Ocurri\xf3 un error en el registro. Por favor intente nuevamente: "+e.statusText)})).catch((function(e){t.setState({user:{nombre:"",apellido:"",username:"",password:"",seller:!1,email:"",razonSocial:"",emailCorporativo:""},error:e,isLoaded:!0}),alert("Ocurri\xf3 un error en el registro. Por favor intente nuevamente ")}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded,n=e.user,r=Object(y.b)().currentUser;console.log(r);var s=Object(v.jsx)("br",{});return r&&r.displayName,n.seller&&(s=Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Raz\xf3n Social:",Object(v.jsx)("input",{type:"text",name:"razonSocial",value:n.razonSocial,onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Mail Corporativo:",Object(v.jsx)("input",{name:"emailCorporativo",type:"email",value:n.emailCorporativo,onChange:this.handleFieldChange})]})})]})),t?Object(v.jsxs)("div",{children:["Error: ",t.message]}):a?"auth"===this.state.screen?Object(v.jsxs)(j.a,{className:"registerContainer",children:[Object(v.jsx)("img",{src:q,width:"150px"})," ",Object(v.jsx)("br",{})," ",Object(v.jsx)("br",{}),Object(v.jsx)(m.a,{onClick:this.handleGoogleSignIn,children:"Registrarme con Google"})]}):Object(v.jsx)("div",{className:"product-form",children:Object(v.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Nombre:",Object(v.jsx)("input",{type:"text",name:"nombre",value:n.nombre,onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Apellido:",Object(v.jsx)("input",{type:"text",name:"apellido",value:n.apellido,onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Nombre de usuario:",Object(v.jsx)("input",{type:"text",name:"username",value:n.username,onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Mail:",Object(v.jsx)("input",{name:"email",type:"email",value:n.email,onChange:this.handleFieldChange})]})}),Object(v.jsx)("div",{className:"form-field",children:Object(v.jsxs)("label",{children:["Es vendedor?:",Object(v.jsx)("input",{type:"checkbox",name:"seller",checked:n.seller,onChange:this.handleFieldChange})]})}),s,Object(v.jsx)("div",{className:"form-field",children:Object(v.jsx)("button",{type:"submit",children:"Terminar registro"})})]})}):Object(v.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component),G=(a(101),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={error:null,isLoaded:!0,user:{username:"",password:""}},n.handleGoogleSignIn=n.handleGoogleSignIn.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"handleGoogleSignIn",value:function(e){var t=this;this.setState(Object(h.a)(Object(h.a)({},this.state),{},{isLoaded:!1}));var a=new y.a,n=Object(y.b)();Object(y.c)(n,a).then((function(e){y.a.credentialFromResult(e);e.user.getIdToken(!0).then((function(e){var a={method:"GET",headers:{Authorization:"Bearer "+e,Accept:"application/json"}};console.log(e),fetch("https://arq1-meli-grupo-e.herokuapp.com/users/login",a).then((function(e){return console.log(e.status),403===e.status?(alert("Autenticaci\xf3n inv\xe1lida"),null):404===e.status?(alert("Usuario no registrado. Por favor, proceda a realizar el registro de su cuenta"),null):e.json()})).then((function(e){console.log(e),e?(t.setState({error:null,isLoaded:!0}),localStorage.setItem("user",e._id),localStorage.setItem("username",e.username),localStorage.setItem("seller",e.seller.toString()),t.props.onUserLogin()):(t.setState({isLoaded:!0}),alert("Ocurri\xf3 un error en el ingreso. Por favor intente nuevamente"))})).catch((function(e){t.setState({error:e,isLoaded:!0}),console.log(JSON.stringify(e)),alert("Ocurri\xf3 un error en el ingreso Por favor intente nuevamente ")}))})).catch((function(e){}))})).catch((function(e){e.code;var t=e.message;e.email,y.a.credentialFromError(e);alert(t)}))}},{key:"render",value:function(){var e=this.state,t=e.error,a=e.isLoaded;e.user;return t?Object(v.jsxs)("div",{children:["Error: ",t.message]}):a?Object(v.jsxs)("div",{className:"loginSection",children:[Object(v.jsx)("img",{src:q,width:"100px"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(m.a,{onClick:this.handleGoogleSignIn,variant:"success",children:"Iniciar sesi\xf3n con Google"})]}):Object(v.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component)),M=(a(102),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleDelete=function(e){n.setState(Object(h.a)(Object(h.a)({},n.state),{},{isLoaded:!1})),Object(y.b)().currentUser.getIdToken(!0).then((function(t){fetch("https://arq1-meli-grupo-e.herokuapp.com/products/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+t}}).then((function(e){console.log(e),n.setState(Object(h.a)(Object(h.a)({},n.state),{},{error:null,isLoaded:!0})),n.componentDidMount()})).catch((function(e){n.setState(Object(h.a)(Object(h.a)({},n.state),{},{error:e,isLoaded:!0}))}))}))},n.handleEdit=function(e){n.props.onProductEdit(e)},n.state={error:null,isLoaded:!1,items:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;null!=Object(y.b)().currentUser?Object(y.b)().currentUser.getIdToken(!0).then((function(t){var a={method:"GET",headers:{Authorization:"Bearer "+t}};fetch("https://arq1-meli-grupo-e.herokuapp.com/products/"+localStorage.getItem("user"),a).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoaded:!0,items:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))})):alert("Su sesi\xf3n expir\xf3, vuelva a identificarse")}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,n=t.isLoaded,r=t.items;return a?Object(v.jsxs)("div",{children:["Error: ",a.message]}):n?Object(v.jsx)(j.a,{fluid:"lg",style:{padding:"1%"},children:Object(v.jsx)(O.a,{children:r.map((function(t){return Object(v.jsx)(f.a,{children:Object(v.jsxs)(x.a,{style:{width:"18rem",height:"500px"},children:[Object(v.jsx)(x.a.Img,{variant:"top",src:t.photo}),Object(v.jsxs)(x.a.Body,{children:[Object(v.jsx)(x.a.Title,{children:t.nombre}),Object(v.jsx)(x.a.Text,{children:t.descripcion})]}),Object(v.jsxs)(x.a.Text,{children:["$ ",t.valor]}),Object(v.jsx)(x.a.Link,{onClick:function(){e.handleDelete(t._id)},children:"Eliminar"}),Object(v.jsx)(x.a.Link,{onClick:function(){e.handleEdit(t)},children:"Editar"})]})},t._id)}))})}):Object(v.jsx)("div",{children:"Cargando..."})}}]),a}(r.a.Component)),z=a(114),R=(a(103),function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).purchaseProduct=function(){var e=localStorage.getItem("user"),t={product:n.state.product._id,taxes:n.state.product.valor*n.state.amount,buyer:e,formaPago:n.state.formaPago};console.log(t),Object(y.b)().currentUser.getIdToken(!0).then((function(e){var a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(t)};fetch("https://arq1-meli-grupo-e.herokuapp.com/sales",a).then((function(e){console.log(e),200==e.status?(n.setState(Object(h.a)(Object(h.a)({},n.state),{},{error:null,isLoaded:!0})),n.props.onSellCreated()):(alert(e.statusText),n.setState(Object(h.a)(Object(h.a)({},n.state),{},{error:e.statusText,isLoaded:!0})))})).catch((function(e){console.log(e),n.setState(Object(h.a)(Object(h.a)({},n.state),{},{error:e,isLoaded:!0}))}))}))},n.state={error:null,isLoaded:!1,product:{},amount:1,formaPago:"Cash"},n.handleChangeAmount=n.handleChangeAmount.bind(Object(u.a)(n)),n.handlePaymentChanged=n.handlePaymentChanged.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"handleChangeAmount",value:function(e){this.setState(Object(h.a)(Object(h.a)({},this.state),{},{amount:e.target.value}))}},{key:"handlePaymentChanged",value:function(e){this.setState(Object(h.a)(Object(h.a)({},this.state),{},{formaPago:e.target.value})),console.log(e.target.value)}},{key:"componentDidMount",value:function(){var e=this,t=this.props.productId;this.setState({isLoaded:!1}),fetch("https://arq1-meli-grupo-e.herokuapp.com/product/"+t).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({isLoaded:!0,product:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){return this.state.isLoaded?Object(v.jsx)(j.a,{children:Object(v.jsxs)(x.a,{className:"text-center",children:[Object(v.jsx)(x.a.Header,{children:this.state.product.nombre}),Object(v.jsx)(x.a.Img,{variant:"top",className:"productImg",src:this.state.product.photo}),Object(v.jsxs)(x.a.Body,{children:[Object(v.jsxs)(x.a.Title,{children:["$ ",this.state.product.valor]}),Object(v.jsx)(x.a.Text,{children:this.state.product.descripcion}),Object(v.jsxs)(p.a,{className:"mb-3",children:[Object(v.jsx)(p.a.Text,{id:"basic-addon1",children:"Cantidad a comprar: "}),Object(v.jsx)(g.a,{placeholder:"0","aria-label":"0","aria-describedby":"basic-addon1",type:"number",min:"1",max:this.state.product.stock,value:this.state.amount,onChange:this.handleChangeAmount}),Object(v.jsxs)(B.a.Select,{"aria-label":"Medio de pago",onChange:this.handlePaymentChanged,defaultValue:"Cash",children:[Object(v.jsx)("option",{children:"-No seleccionado-"}),Object(v.jsx)("option",{value:"Cash",children:"Efectivo"}),Object(v.jsx)("option",{value:"Card",children:"Tarjeta"}),Object(v.jsx)("option",{value:"MercadoPago",children:"MercadoPago"}),Object(v.jsx)("option",{value:"Transferencia",children:"Transferencia"}),Object(v.jsx)("option",{value:"Otros",children:"Otros"})]})]}),Object(v.jsx)(m.a,{variant:"primary",onClick:this.purchaseProduct,children:"Comprar"})]}),Object(v.jsxs)(x.a.Footer,{className:"text-muted",children:[" Quedan disponibles: ",this.state.product.stock-this.state.amount]})]})}):Object(v.jsx)(z.a,{animation:"border",role:"status",children:Object(v.jsx)("span",{className:"visually-hidden",children:"Cargando..."})})}}]),a}(r.a.Component)),V=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleSearchCategory=function(e){n.setState({screen:"list",category:e})},n.handleSearchProduct=function(e){n.setState({screen:"list",searchText:e})},n.handleProductCreation=function(){alert("Producto Creado")},n.handleLogin=function(){n.setState({screen:"list"})},n.handleUserLogin=function(){n.setState({screen:"login"})},n.handleCreationScreen=function(){n.setState({screen:"createProduct"})},n.handleProductEdit=function(e){n.setState({screen:"editProduct",product:e})},n.handleProductBuy=function(e){n.setState({screen:"productInfo",product:e})},n.handleSellCreated=function(){alert("Compra realizada con \xe9xito!"),n.setState({screen:"list"})},n.handleHomeScreen=function(){n.setState({screen:"login"})},n.handleRegisterScreen=function(){n.setState({screen:"createUser"})},n.handleUserProductsScreen=function(){n.setState({screen:"userProducts"})},n.state={screen:"list"},n}return Object(i.a)(a,[{key:"render",value:function(){var e;switch(this.state.screen){case"createProduct":e=Object(v.jsx)(N,{onProductCreated:this.handleProductCreation});break;case"createUser":e=Object(v.jsx)(D,{onUserCreated:this.handleHomeScreen});break;case"list":e=Object(v.jsx)(C,{search:this.state.searchText,category:this.state.category,onProductBuy:this.handleProductBuy});break;case"userProducts":e=Object(v.jsx)(M,{onProductEdit:this.handleProductEdit});break;case"editProduct":e=Object(v.jsx)(N,{onProductCreated:this.handleProductCreation,product:this.state.product});break;case"productInfo":e=Object(v.jsx)(R,{productId:this.state.product,onSellCreated:this.handleSellCreated});break;default:e=Object(v.jsx)(G,{onUserLogin:this.handleLogin})}return Object(v.jsxs)("div",{className:"App","data-testid":"App",children:[Object(v.jsx)(w,{onProductCreationEvent:this.handleCreationScreen,onLogin:this.handleUserLogin,onHome:this.handleHomeScreen,onRegister:this.handleRegisterScreen,onUserProducts:this.handleUserProductsScreen,onCategory:this.handleSearchCategory,onSearchProduct:this.handleSearchProduct}),e]})}}]),a}(r.a.Component),_=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,121)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,o=t.getTTFB;a(e),n(e),r(e),s(e),o(e)}))};a(104);o.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(V,{})}),document.getElementById("root")),_()},90:function(e,t,a){},94:function(e,t,a){},96:function(e,t,a){},99:function(e,t,a){}},[[105,1,2]]]);
//# sourceMappingURL=main.2539e765.chunk.js.map